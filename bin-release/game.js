window.onload=function(){"use strict";function a(){function a(a,b,c,h){var i=4;C(jb,Ab,zb,2),jb.beginPath(),jb.moveTo(a(-i),b(-i)),jb.lineTo(a(X+Y),b(-i)),jb.lineTo(a(X+Y),b(X)),jb.arcTo(a(X+Y),b(X+Y),a(X),b(X+Y),Y),jb.lineTo(a(-i),b(X+Y)),jb.closePath(),jb.fill(),jb.stroke(),k(l(a(X),b(X),Y,Ob)),k(m(a(0),b(X+Y),a(X),b(X+Y),Ob)),k(m(a(X+Y),b(0),a(X+Y),b(X),Ob)),C(jb,Db[c][1]);var j=a==r?f:g;jb.fillText(R(j),a(X+Y+130)-2,b(50)-3),C(jb,Db[h][1]),j=b==r?d:e,jb.fillText(R(j),a(50)-2,b(X+Y+130)-3)}var b=A(hb,hb),c=B(b);D(c,0,0,hb,hb,wb),D(c,0,0,hb-1,hb-1,xb),D(c,0,0,hb-2,hb-2,vb),D(jb,0,0,fb,fb,b),jb.globalAlpha=.1,D(jb,0,fb-X-2,fb,X,Db[S][1]),D(jb,fb-X-2,0,X,fb,Db[T][1]),D(jb,0,0,fb,X,Db[U][1]),D(jb,0,0,X,fb,Db[V][1]),jb.globalAlpha=1,jb.globalCompositeOperation="source-over",G(jb,0,0,fb,fb,yb),G(jb,fb,0,0,fb,yb),F(jb,gb,gb,8,vb,yb);var d=8679,e=8681,f=8678,g=8680;jb.font="64px sans-serif",jb.textAlign="center",jb.textBaseline="middle",a(r,r,2,3),a(r,s,0,3),a(s,r,2,1),a(s,s,0,1);var h=rb,i=h/2;ub.translate(4,4),C(ub,"#aef","#5af",2),ub.beginPath(),ub.moveTo(i,0),ub.quadraticCurveTo(h,-3,h,i),ub.quadraticCurveTo(h,h+1,i,h-2),ub.quadraticCurveTo(2,h,0,i),ub.quadraticCurveTo(-3,-1,i,0),ub.fill(),ub.stroke(),G(ub,8,4,4,20,"#fff",2),G(ub,16,2,8,26,0,1),G(ub,36,14,18,36,0,1),G(ub,38,18,26,36,0,2),G(ub,i-4,10,i-4,18,"#58f",2),G(ub,i+4,10,i+4,18),ub.translate(h+8,0),C(ub,"#fa0","#f00",2),ub.beginPath(),ub.moveTo(i,-4),ub.lineTo(i+6,14),ub.lineTo(h-4,8),ub.quadraticCurveTo(h,h+3,i,h-2),ub.quadraticCurveTo(2,h,4,8),ub.lineTo(i-6,14),ub.lineTo(i,-4),ub.fill(),ub.stroke(),G(ub,i-3,26,i-8,20),G(ub,i+3,26,i+8,20),ub.translate(h+8,0),C(ub,"#fd7","#d72",2),ub.beginPath(),ub.moveTo(i,0),ub.quadraticCurveTo(h,10,h-8,h-8),ub.quadraticCurveTo(h,h+1,i+2,h-6),ub.quadraticCurveTo(14,h-12,2,h-4),ub.quadraticCurveTo(-2,h-10,4,i),ub.quadraticCurveTo(0,0,i,0),ub.fill(),ub.stroke(),F(ub,10,7,1,"#d72"),F(ub,24,9,1),F(ub,7,20,1),F(ub,20,14,1),F(ub,8,30,1),F(ub,28,32,1);for(var j=0;2>j;j++){var n;0===j?(ub.globalCompositeOperation="destination-out",n="#000"):(ub.globalCompositeOperation="source-over",n=null),ub.scale(1,1.5),F(ub,13,14,4,n,"#d72",1),ub.scale(1,2/3),ub.scale(1,1.5),F(ub,26,14,4,n,"#d72",1),ub.scale(1,2/3)}ub.translate(h+8,0),ub.lineCap="round",F(ub,i,i,i-4,null,"#fff",2),C(0,0,1),ub.beginPath(),ub.arc(i,i,i-8,3.2,4.4),ub.stroke(),F(ub,i-4,i+4,4,0,"#fff",2),F(ub,i+4,i+4,4,0,"#fff",2)}function b(){_b=0,$b=!1,Fb=[],Gb=[],Hb=[],Hb.n=0,Gb.n=0,a(),i()}function c(){if(!$b){if(Yb.space)_b++;else if(_b>0){var a=_b/ac;a>1&&(a=1),Ib.boostX=3*(1+Q()),Ib.boostY=-Ub,Ib.boostCpt=10+50*a,$b=!0}Yb.R&&($b=!0)}for(var b=0;b<Jb.length;b++){var c,d=Jb[b],e=!d.mirror;c=1==d.table?e?Yb.up||Yb.right:Yb.down||Yb.left:e?Yb.up||Yb.left:Yb.down||Yb.right;var f=d.ux,g=d.uy;d.cpt=d.cpt||0;var h=7;if(d.max=!1,c?d.cpt<h?d.cpt++:d.max=!0:d.cpt>0&&d.cpt--,d.prevX2=d.x2,d.prevY2=d.y2,d.movingUp=c&&!d.max,d.moving=0!==d.cpt,d.cpt>0){var i=d.amax*(d.cpt/h);d.mirror&&(i*=-1);var k=N.cos(i),l=N.sin(i);f=d.ux*k-d.uy*l,g=d.ux*l+d.uy*k}d._ux=f,d._uy=g,d.x2=d.x+f,d.y2=d.y+g}if(Zb.middle&&(_b=0,$b=!0,Ib.x=Zb.x,Ib.y=Zb.y,Ib.a.x=Ib.a.y=0,Ib.v.x=Ib.v.y=0,Ib.boostCpt=0,Zb.right=!1),Zb.right&&(cc.x=Zb.x-Ib.x,cc.y=Zb.y-Ib.y,v(cc),Ib.boostCpt=6,Ib.boostX=2.5*cc.x,Ib.boostY=2.5*cc.y,Zb.right=!1),Zb.left&&(cc.x=Zb.x-Ib.x,cc.y=Zb.y-Ib.y,v(cc),Zb.leftCpt%10===0)){var m;Gb.length==Gb.n?(m=j(Mb,Sb),Gb.push(m)):m=Gb[Gb.n],Gb.n++;var n=10;m.x=Ib.x+cc.x*(n+Vb),m.y=Ib.y+cc.y*(n+Vb),m.v.x=cc.x*n,m.v.y=cc.y*n,m.cpt=100}Zb.left?Zb.leftCpt++:Zb.leftCpt=0}function d(){var a,b,c,d;for(b=Kb.length,d=Kb.length+Hb.n,a=0;d>a;a++)c=b>a?Kb[a]:Hb[a-b],c.a=c.a+c.da,c.x=gb+N.cos(c.a)*c.d,c.y=gb+N.sin(c.a)*c.d;if($b){Ib.boostCpt>0&&(Ib.boostCpt--,Ib.a.x=Ib.boostX,Ib.a.y=Ib.boostY);var e=0,f=0,g=Wb;t=gb-Ib.x,A=gb-Ib.y;var h=$/2,i=u(t,A);h>i&&(t/=i,A/=i,g*=.1+.9*i/h);var j=Ib.x-gb,k=Ib.y-gb;k>j?k>-j?f=g:e=-g:k>-j?e=g:f=-g,Ib.a.x+=e,Ib.a.y+=f,Ib.v.x=Ib.v.x+Ib.a.x,Ib.v.y=Ib.v.y+Ib.a.y,Ib.v.x*=Xb,Ib.v.y*=Xb,Ib.v.x*Ib.v.x+Ib.v.y*Ib.v.y>Ub*Ub&&v(Ib.v,Ub),Ib.x+=Ib.v.x,Ib.y+=Ib.v.y,Ib.collide=!1;{Ib.v.x,Ib.v.y}for(d=Fb.length,b=d+Hb.n,a=0;b>a;a++)if(c=d>a?Fb[a]:Hb[a-d],c!=Ib){c.collide=!1;var l,m=cc;if(c.shape==Lb){if(w(Ib,c)){if(c.kind==Tb){if(Eb[Ib.elt]==c.elt&&(c.dead=!0,Ib.elt=-1),c.dead)continue;c.elt!=Ib.elt&&(Ib.elt=-1)}c.collide=!0,m.x=Ib.x-c.x,cc.y=Ib.y-c.y,l=u(m.x,m.y),m.l=c.r+Ib.r-l,m.x=m.x/l,m.y=m.y/l}}else if(c.shape==Mb){var n=c.kind==Rb&&c.movingUp;if(!n&&x(Ib,c,m)){c.collide=!0,y(bc,c.x,c.y,c.x2,c.y2);var o=z(bc,Ib.x,Ib.y)!==z(bc,Ib.prevX,Ib.prevY);0>=o?l=Ib.r-m.l:(l=Ib.r+m.l,m.x*=-1,m.y*=-1),m.x/=m.l,m.y/=m.l,m.l=l}if(n){var p,q,r=x(Ib,c,m),s=1==c.table||3==c.table;if(r||(y(bc,c.x,c.y,c.prevX2,c.prevY2),p=z(bc,Ib.prevX,Ib.prevY,s),y(bc,c.x,c.y,c.x2,c.y2),q=z(bc,Ib.x,Ib.y,s)),r||p!==q){var t=Ib.x-c.x,A=Ib.y-c.y,B=t*c._ux+A*c._uy;if((r||B>0)&&(r||t*t+A*A<c.l*c.l)){c.collide=!0;var C=(u(t,A),B/c.l);m.x=c.x+C*c._ux/c.l,m.y=c.y+C*c._uy/c.l,m.x=Ib.x-m.x,m.y=Ib.y-m.y,m.l=u(m.x,m.y),m.x/=m.l,m.y/=m.l;var D=c._uy/c.l,E=-c._ux/c.l;(c.mirror&&(0===c.table||3==c.table)||!c.mirror&&(1==c.table||2==c.table))&&(D*=-1,E*=-1);var F=D*m.x+E*m.y;0>F&&(m.x*=-1,m.y*=-1),m.l=m.l+Ib.r,Ib.x+=m.x*m.l,Ib.y+=m.y*m.l,Ib.collide=!0;var G=C/c.l;G=.2+(.3*G+.7*G*G);var H=20*G>>0,I=Ub*G,J=m.x*I,K=m.y*I;Ib.boostCpt?(Ib.boostCpt+=H>2?2:H,Ib.boostX=.2*J+.8*Ib.boostX,Ib.boostY=.2*K+.8*Ib.boostY):(Ib.boostCpt=H,Ib.boostX=J,Ib.boostY=K),Ib.boostX*=.6+.8*Q(),Ib.boostY*=.6+.8*Q(),Ib.elt=c.table;continue}}}}if(c.collide){c.colCpt=20,Ib.x+=m.x*m.l,Ib.y+=m.y*m.l,Ib.collide=!0;var L=u(Ib.v.x,Ib.v.y),M=Ib.v.x/L,O=Ib.v.y/L,P=-m.y,R=m.x,S=P*M+R*O;0>S&&(P=-P,R=-R);var T=M*m.x+O*m.y;0>T&&(T=-T);var U=N.sin(N.acos(T));0>U&&(U=-U);var V=.2;c.kind==Pb?V=1.5:c.kind==Tb&&(V=.5),m.x*=T*V*L,m.y*=T*V*L,P*=U*L,R*=U*L,Ib.v.x=m.x+P,Ib.v.y=m.y+R}}Ib.a.x=Ib.a.y=0,Ib.prevX=Ib.x,Ib.prevY=Ib.y,Ib.x+Vb<0?$b=!1:Ib.x-Vb>fb?$b=!1:Ib.y+Vb<0?$b=!1:Ib.y-Vb>fb&&($b=!1)}var W;for(a=0,b=Gb.n;b>a;a++)W=Gb[a],W.cpt--,W.cpt>0&&(W.x+=W.v.x,W.y+=W.v.y);for(a=0;a<Gb.n;a++)W=Gb[a],0===W.cpt&&(Gb[a]=Gb[Gb.n-1],Gb[Gb.n-1]=W,Gb.n--,a--)}function e(){db=bb,eb=cb;var a=Ib.x,b=Ib.y,c=a-gb,d=b-gb,e=c,f=d;0>e&&(e*=-1),0>f&&(f*=-1);var g=W/2+Y;if(g>e&&g>f){var h=e-g,i=f-g,j=h*h+i*i;if(g*g>j){var k=P(j);h=h*g/k,i=i*g/k,a=h+g,b=i+g,0>c&&(a=-a),0>d&&(b=-b),a=gb+a,b=gb+b}}else f>e?a=gb:b=gb;a=t(a,Ib.x-.3*$,Ib.x+.3*$),b=t(b,Ib.y-.3*_,Ib.y+.3*_),a=t(a-$/2,0,fb-$),b=t(b-_/2,0,fb-_),$b?(bb+=.3*(a-bb),cb+=.3*(b-cb)):(bb=a,cb=b)}function f(){var a=1;H(lb),H(pb),a&&(E(lb,mb,0,0),nb.clearRect(0,0,$,_),nb.save(),nb.globalAlpha=.9,E(nb,kb,-bb+db,-cb+eb),nb.restore(),H(lb),Ib.boostCpt>0?F(nb,Ib.prevX-bb,Ib.prevY-cb,6,Db[Ib.elt][1]):F(nb,Ib.x-bb,Ib.y-cb,2,Db[Ib.elt][1]));for(var b=0,c=Fb.length;c>b;b++){var d,e,f,g=Fb[b],h=g.x-bb,i=g.y-cb;if(g==Ib){if(_b>0&&!$b){var j=4*t(_b/ac,0,1)>>0;h+=j*Q()>>0,i+=j*Q()>>0,4==j&&(e="#f00")}var k=N.atan2(Ib.v.y,Ib.v.x);Ib.cpt=++Ib.cpt%20;var l=Ib.cpt;l>10&&(l=20-l),e=Db[Ib.elt][1],d=Db[Ib.elt][0],0===l?F(pb,Ib.x-bb,Ib.y-cb,Vb,d,e):(C(pb,d,e,2),l*=.3*O/10,pb.beginPath(),pb.arc(Ib.x-bb,Ib.y-cb,Ib.r,k+l,k-l),pb.lineTo(Ib.x-bb,Ib.y-cb),pb.closePath(),pb.fill(),pb.stroke())}else g.shape==Lb?(g.kind==Ob?(d=0,e=0):(f=2,e=zb,d="#000",g.colCpt>0&&(g.colCpt--,e=Bb)),(d||e)&&F(pb,h,i,g.r,d,e,f)):g.shape==Mb&&(g.kind==Ob?e=0:(e=zb,g.kind==Rb&&(e=Db[g.table][1])),e&&G(pb,g.x-bb,g.y-cb,g.x2-bb,g.y2-cb,e,2))}for(b=0;b<Hb.n;b++){var m=1,n=Hb[b],o=rb+2*qb;if(n.dead){if(n.cpt-=10,0===n.cpt){m=Hb[Hb.n-1],Hb[b]=m,Hb[Hb.n-1]=n,Hb.n--,b--;continue}m=n.cpt/50}else n.cpt<50&&(n.cpt++,m=n.cpt/50);pb.globalAlpha=.2*m,F(pb,n.x-bb,n.y-cb,n.r,Db[n.elt][0]),n.elt==V&&(pb.globalAlpha=1,pb.globalCompositeOperation="destination-out",F(pb,n.x-bb,n.y-cb,17,Db[n.elt][0]),pb.globalCompositeOperation="source-over"),pb.globalAlpha=m,F(pb,n.x-bb,n.y-cb,n.r,null,Db[n.elt][0]),pb.drawImage(tb,n.elt*o,0,o,o,n.x-o/2-bb,n.y-o/2-cb,o,o)}pb.globalAlpha=1;var p;for(b=0,c=Gb.n;c>b;b++)p=Gb[b],F(pb,p.x-bb,p.y-cb,4,Cb),a&&G(nb,p.x-bb,p.y-cb,p.x-p.v.x-bb,p.y-p.v.y-cb,Cb,2);E(lb,ib,-bb,-cb),a&&E(lb,mb,0,0),E(lb,ob,0,0)}function g(){for(var a=4;Hb.n<a;){var b;Hb.length==Hb.n?(b=j(Lb,Tb),Hb.push(b),b.elt=Hb.n%4,b.r=sb):b=Hb[Hb.n],Hb.n++;var c=Kb[Hb.n%Kb.length];b.x=c.x,b.y=c.y,b.cpt=0,b.dead=0,b.da=-2*c.da,b.a=c.a,b.d=c.d}}function h(){stb&&stb(),c(),d(),e(),f(),g(),window.requestAnimationFrame(h),ste&&ste()}function i(){Ib=k(l(gb,fb-50,Vb,Nb)),Ib.cpt=0,Ib.elt=-1,o(m(0,220,150,100,Qb)),Kb=[];for(var a=6,b=0;a>b;b++){var c=sb+30*Q(),d=80+c+(Z-2*c-80)*b/a>>0,e=2*Q()*O,f=l(0,0,c,Pb);Kb.push(k(f));var g=.2+.2*Q()*(Q()>.5?-1:1);f.da=g/d,f.a=e,f.d=d}o(m(150,100,300,30,Rb)),Jb=Fb.slice(-8);var h=Jb[0],i=u(h.x-h.x2,h.y-h.y2),j=2*-N.acos((h.x2-h.x)/i);for(b=0;b<Jb.length;b++)h=Jb[b],h.l=i,h.ux=h.x2-h.x,h.uy=h.y2-h.y,h.amax=j,(1==h.table||2==h.table)&&(h.amax*=-1)}function j(a,b,c,d){return{x:c||0,y:d||0,shape:a,kind:b,v:{x:0,y:0},a:{x:0,y:0}}}function k(a){return Fb.push(a),a}function l(a,b,c,d){var e=j(Lb,d,a,b);return e.r=c,e}function m(a,b,c,d,e){var f=j(Mb,e,a,b);return f.x2=c,f.y2=d,f}function n(a){for(var b=0;4>b;b++){var c=q(a);p(c,"x","y",b),c.shape==Mb&&p(c,"x2","y2",b),k(c),c.table=b}}function o(a){n(a),a.x=W-a.x,a.shape==Mb&&(a.x2=W-a.x2),a.mirror=!0,n(a)}function p(a,b,c,d){var e=a[b],f=a[c];if(0===d||2==d)e+=X+Y,0===d&&(f=fb-f);else{var g=f;f=X+Y+e,e=g,1==d&&(e=fb-e)}a[b]=e>>0,a[c]=f>>0}function q(a){return JSON.parse(JSON.stringify(a))}function r(a){return a}function s(a){return fb-a}function t(a,b,c){return b>a?b:a>c?c:a}function u(a,b){return P(a*a+b*b)}function v(a,b){b=(b||1)/u(a.x,a.y),a.x*=b,a.y*=b}function w(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.r+b.r;return e*e>c*c+d*d}function x(a,b,c){var d=a.x,e=a.y,f=a.r,g=b.x,h=b.y,i=b.x2,j=b.y2,k=i-g,l=j-h,m=N.sqrt(k*k+l*l),n=(i-g)/m,o=(j-h)/m,p=n*(d-g)+o*(e-h),q=p*n+g,r=p*o+h;if((i>g&&q>=g&&i>=q||g>i&&q>=i&&g>=q||g==i&&q==g)&&(j>h&&r>=h&&j>=r||h>j&&r>=j&&h>=r||h==j&&r==h)){var s=r-e,t=q-d,u=P(t*t+s*s);if(f>=u)return c.ex=q,c.ey=r,c.x=-t,c.y=-s,c.l=u,!0}return!1}function y(a,b,c,d,e){b==d?(a.vert=!0,a.x=b):(a.vert=!1,a.m=(c-e)/(b-d),a.p=c-a.m*b)}function z(a,b,c,d){return a.vert?b<a.x:d?b>(c-a.p)/a.m:c>a.m*b+a.p}function A(a,b){var c=L.createElement("canvas");return c.width=a,c.height=b,c}function B(a){return a.getContext("2d")}function C(a,b,c,d){0!==b&&(a.fillStyle=b),0!==c&&(a.strokeStyle=c),0!==d&&(a.lineWidth=d)}function D(a,b,c,d,e,f){f&&(f.width&&(f=a.createPattern(f,"repeat")),C(a,f)),a.fillRect(b,c,d,e)}function E(a,b,c,d){a.drawImage(b,c,d)}function F(a,b,c,d,e,f,g){C(a,e,f,g||2),a.beginPath(),a.arc(b,c,d,0,2*O,!1),e&&a.fill(),f&&a.stroke(),a.closePath()}function G(a,b,c,d,e,f,g){C(a,0,f,g||2),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.stroke()}function H(a){a.clearRect(0,0,$,_)}function I(a,b){b||(b=window.e);var c=b.keyCode;b.charCode&&!c&&(c=b.charCode),Yb[dc[c]]=a}function J(a,b){var c,d;"which"in b?(c=3==b.which,d=2==b.which):"button"in b&&(c=2==b.button,d=1==b.button),c?Zb.right=a:d?Zb.middle=a:Zb.left=a,Zb.x=b.clientX+bb,Zb.y=b.clientY+cb}var K=window,L=K.document,M=L.body,N=K.Math,O=N.PI,P=N.sqrt,Q=N.random,R=String.fromCharCode,S=0,T=1,U=2,V=3,W=700,X=220,Y=200,Z=Y+W/2;Z=u(Z,Z)-Y>>0;var $,_,ab,bb,cb,db,eb,fb=W+2*X+2*Y,gb=fb/2,hb=20,ib=A(fb,fb),jb=B(ib),kb=A($,_),lb=B(kb),mb=A($,_),nb=B(mb),ob=A($,_),pb=B(ob),qb=4,rb=40,sb=rb-2,tb=A(4*(rb+2*qb),rb+2*qb),ub=B(tb);window.onresize=function(){$=t(K.innerWidth,W,fb),_=t(K.innerHeight,W,fb),ab=N.min($,_),ob.width=mb.width=kb.width=$-=$%2,ob.height=mb.height=kb.height=_-=_%2},M.onresize(),M.appendChild(kb);var vb="#111",wb="#222",xb="#333",yb="#444",zb="#08e",Ab="#000",Bb="#0d0",Cb="#fa0",Db=[["#aef","#5af"],["#fa0","#f53"],["#a64","#864"],["rgba(255,255,255,0.5","#fff"]];Db[-1]=["#ff6","#ff6"];var Eb={};Eb[S]=T,Eb[T]=S,Eb[U]=V,Eb[V]=U;var Fb,Gb,Hb,Ib,Jb,Kb,Lb="c",Mb="l",Nb="b",Ob="bg",Pb="bp",Qb="o",Rb="p",Sb="s",Tb="m",Ub=15,Vb=14,Wb=.2,Xb=.99,Yb={},Zb={},$b=!1,_b=0,ac=100,bc={},cc={};b(),h();var dc={37:"left",38:"up",39:"right",40:"down",32:"space",27:"esc",82:"R",13:"Enter"};L.onkeyup=function(a){I(!1,a),27==a.keyCode&&(window._stopped?(window._stopped=!1,window.requestAnimationFrame=window._raf):(window._stopped=!0,window._raf=window.requestAnimationFrame,window.requestAnimationFrame=function(){})),13==a.keyCode&&window._stopped&&h()},L.onkeydown=function(a){I(!0,a)},L.onmousedown=function(a){J(!0,a)},L.onmouseup=function(a){J(!1,a)},L.onmousemove=function(a){Zb.x=a.clientX+bb,Zb.y=a.clientY+cb},L.oncontextmenu=function(){return!1}};