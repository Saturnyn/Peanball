window.onload=function(){"use strict";function a(){function a(a,b,c,h){var i=4;C(jb,Ab,zb,2),jb.beginPath(),jb.moveTo(a(-i),b(-i)),jb.lineTo(a(X+Y),b(-i)),jb.lineTo(a(X+Y),b(X)),jb.arcTo(a(X+Y),b(X+Y),a(X),b(X+Y),Y),jb.lineTo(a(-i),b(X+Y)),jb.closePath(),jb.fill(),jb.stroke(),k(l(a(X),b(X),Y,Nb)),k(m(a(0),b(X+Y),a(X),b(X+Y),Nb)),k(m(a(X+Y),b(0),a(X+Y),b(X),Nb)),C(jb,Cb[c][1]);var j=a==r?f:g;jb.fillText(R(j),a(X+Y+130)-2,b(50)-3),C(jb,Cb[h][1]),j=b==r?d:e,jb.fillText(R(j),a(50)-2,b(X+Y+130)-3)}var b=A(hb,hb),c=B(b);D(c,0,0,hb,hb,wb),D(c,0,0,hb-1,hb-1,xb),D(c,0,0,hb-2,hb-2,vb),D(jb,0,0,fb,fb,b),jb.globalAlpha=.1,D(jb,0,fb-X-2,fb,X,Cb[S][1]),D(jb,fb-X-2,0,X,fb,Cb[T][1]),D(jb,0,0,fb,X,Cb[U][1]),D(jb,0,0,X,fb,Cb[V][1]),jb.globalAlpha=1,jb.globalCompositeOperation="source-over",G(jb,0,0,fb,fb,yb),G(jb,fb,0,0,fb,yb),F(jb,gb,gb,8,vb,yb);var d=8679,e=8681,f=8678,g=8680;jb.font="64px sans-serif",jb.textAlign="center",jb.textBaseline="middle",a(r,r,2,3),a(r,s,0,3),a(s,r,2,1),a(s,s,0,1);var h=rb,i=h/2;ub.translate(4,4),C(ub,"#aef","#5af",2),ub.beginPath(),ub.moveTo(i,0),ub.quadraticCurveTo(h,-3,h,i),ub.quadraticCurveTo(h,h+1,i,h-2),ub.quadraticCurveTo(2,h,0,i),ub.quadraticCurveTo(-3,-1,i,0),ub.fill(),ub.stroke(),G(ub,8,4,4,20,"#fff",2),G(ub,16,2,8,26,0,1),G(ub,36,14,18,36,0,1),G(ub,38,18,26,36,0,2),G(ub,i-4,10,i-4,18,"#58f",2),G(ub,i+4,10,i+4,18),ub.translate(h+8,0),C(ub,"#fa0","#f00",2),ub.beginPath(),ub.moveTo(i,-4),ub.lineTo(i+6,14),ub.lineTo(h-4,8),ub.quadraticCurveTo(h,h+3,i,h-2),ub.quadraticCurveTo(2,h,4,8),ub.lineTo(i-6,14),ub.lineTo(i,-4),ub.fill(),ub.stroke(),G(ub,i-3,26,i-8,20),G(ub,i+3,26,i+8,20),ub.translate(h+8,0),C(ub,"#fd7","#d72",2),ub.beginPath(),ub.moveTo(i,0),ub.quadraticCurveTo(h,10,h-8,h-8),ub.quadraticCurveTo(h,h+1,i+2,h-6),ub.quadraticCurveTo(14,h-12,2,h-4),ub.quadraticCurveTo(-2,h-10,4,i),ub.quadraticCurveTo(0,0,i,0),ub.fill(),ub.stroke(),F(ub,10,7,1,"#d72"),F(ub,24,9,1),F(ub,7,20,1),F(ub,20,14,1),F(ub,8,30,1),F(ub,28,32,1);for(var j=0;2>j;j++){var n;0===j?(ub.globalCompositeOperation="destination-out",n="#000"):(ub.globalCompositeOperation="source-over",n=null),ub.scale(1,1.5),F(ub,13,14,4,n,"#d72",1),ub.scale(1,2/3),ub.scale(1,1.5),F(ub,26,14,4,n,"#d72",1),ub.scale(1,2/3)}ub.translate(h+8,0),ub.lineCap="round",F(ub,i,i,i-4,null,"#fff",2),C(0,0,1),ub.beginPath(),ub.arc(i,i,i-8,3.2,4.4),ub.stroke(),F(ub,i-4,i+4,4,0,"#fff",2),F(ub,i+4,i+4,4,0,"#fff",2)}function b(){$b=0,Zb=!1,Eb=[],Fb=[],Gb=[],Gb.n=0,Fb.n=0,a(),i()}function c(){if(!Zb){if(Xb.space)$b++;else if($b>0){var a=$b/_b;a>1&&(a=1),Hb.boostX=3*(1+Q()),Hb.boostY=-Tb,Hb.boostCpt=10+50*a,Zb=!0}Xb.R&&(Zb=!0)}for(var b=0;b<Ib.length;b++){var c,d=Ib[b],e=!d.mirror;c=1==d.table?e?Xb.up||Xb.right:Xb.down||Xb.left:e?Xb.up||Xb.left:Xb.down||Xb.right;var f=d.ux,g=d.uy;d.cpt=d.cpt||0;var h=7;if(d.max=!1,c?d.cpt<h?d.cpt++:d.max=!0:d.cpt>0&&d.cpt--,d.prevX2=d.x2,d.prevY2=d.y2,d.movingUp=c&&!d.max,d.moving=0!==d.cpt,d.cpt>0){var i=d.amax*(d.cpt/h);d.mirror&&(i*=-1);var k=N.cos(i),l=N.sin(i);f=d.ux*k-d.uy*l,g=d.ux*l+d.uy*k}d._ux=f,d._uy=g,d.x2=d.x+f,d.y2=d.y+g}if(Yb.middle&&($b=0,Zb=!0,Hb.x=Yb.x,Hb.y=Yb.y,Hb.a.x=Hb.a.y=0,Hb.v.x=Hb.v.y=0,Hb.boostCpt=0,Yb.right=!1),Yb.right&&(bc.x=Yb.x-Hb.x,bc.y=Yb.y-Hb.y,v(bc),Hb.boostCpt=4,Hb.boostX=2.5*bc.x,Hb.boostY=2.5*bc.y,Yb.right=!1),Yb.left&&(bc.x=Yb.x-Hb.x,bc.y=Yb.y-Hb.y,v(bc),Yb.leftCpt%10===0)){var m;Fb.length==Fb.n?(m=j(Lb,Rb),Fb.push(m)):m=Fb[Fb.n],Fb.n++;var n=10;m.x=Hb.x+bc.x*(n+Ub),m.y=Hb.y+bc.y*(n+Ub),m.v.x=bc.x*n,m.v.y=bc.y*n,m.cpt=100}Yb.left?Yb.leftCpt++:Yb.leftCpt=0}function d(){var a,b,c,d;for(b=Jb.length,d=Jb.length+Gb.n,a=0;d>a;a++)c=b>a?Jb[a]:Gb[a-b],c.a+=c.da,c.x=gb+N.cos(c.a)*c.d,c.y=gb+N.sin(c.a)*c.d;if(Zb){Hb.boostCpt>0&&(Hb.boostCpt--,Hb.a.x=Hb.boostX,Hb.a.y=Hb.boostY);var e=0,f=0,g=Vb;t=gb-Hb.x,A=gb-Hb.y;var h=$/2,i=u(t,A);h>i&&(t/=i,A/=i,g*=.1+.9*i/h);var j=Hb.x-gb,k=Hb.y-gb;k>j?k>-j?f=g:e=-g:k>-j?e=g:f=-g,Hb.a.x+=e,Hb.a.y+=f,Hb.v.x=Hb.v.x+Hb.a.x,Hb.v.y=Hb.v.y+Hb.a.y,Hb.v.x*=Wb,Hb.v.y*=Wb,Hb.v.x*Hb.v.x+Hb.v.y*Hb.v.y>Tb*Tb&&v(Hb.v,Tb),Hb.x+=Hb.v.x,Hb.y+=Hb.v.y,Hb.collide=!1;{Hb.v.x,Hb.v.y}for(d=Eb.length,b=d+Gb.n,a=0;b>a;a++)if(c=d>a?Eb[a]:Gb[a-d],c!=Hb){c.collide=!1;var l,m=bc;if(c.shape==Kb){if(w(Hb,c)){if(c.kind==Sb){if(Db[Hb.elt]==c.elt&&(c.dead=!0),c.dead||c.elt==Hb.elt)continue;c.elt!=Hb.elt&&(Hb.elt=-1)}c.collide=!0,m.x=Hb.x-c.x,bc.y=Hb.y-c.y,l=u(m.x,m.y),m.l=c.r+Hb.r-l,m.x=m.x/l,m.y=m.y/l}}else if(c.shape==Lb){var n=c.kind==Qb&&c.movingUp;if(!n&&x(Hb,c,m)){c.collide=!0,y(ac,c.x,c.y,c.x2,c.y2);var o=z(ac,Hb.x,Hb.y)!==z(ac,Hb.prevX,Hb.prevY);0>=o?l=Hb.r-m.l:(l=Hb.r+m.l,m.x*=-1,m.y*=-1),m.x/=m.l,m.y/=m.l,m.l=l}if(n){var p,q,r=x(Hb,c,m),s=1==c.table||3==c.table;if(r||(y(ac,c.x,c.y,c.prevX2,c.prevY2),p=z(ac,Hb.prevX,Hb.prevY,s),y(ac,c.x,c.y,c.x2,c.y2),q=z(ac,Hb.x,Hb.y,s)),r||p!==q){var t=Hb.x-c.x,A=Hb.y-c.y,B=t*c._ux+A*c._uy;if((r||B>0)&&(r||t*t+A*A<c.l*c.l)){c.collide=!0;var C=(u(t,A),B/c.l);m.x=c.x+C*c._ux/c.l,m.y=c.y+C*c._uy/c.l,m.x=Hb.x-m.x,m.y=Hb.y-m.y,m.l=u(m.x,m.y),m.x/=m.l,m.y/=m.l;var D=c._uy/c.l,E=-c._ux/c.l;(c.mirror&&(0===c.table||3==c.table)||!c.mirror&&(1==c.table||2==c.table))&&(D*=-1,E*=-1);var F=D*m.x+E*m.y;0>F&&(m.x*=-1,m.y*=-1),m.l=m.l+Hb.r,Hb.x+=m.x*m.l,Hb.y+=m.y*m.l,Hb.collide=!0;var G=C/c.l;G=.2+(.3*G+.7*G*G);var H=8*G>>0,I=Tb*G,J=m.x*I,K=m.y*I;Hb.boostCpt?(Hb.boostCpt+=H>2?2:H,Hb.boostX=.2*J+.8*Hb.boostX,Hb.boostY=.2*K+.8*Hb.boostY):(Hb.boostCpt=H,Hb.boostX=J,Hb.boostY=K),Hb.boostX*=.6+.8*Q(),Hb.boostY*=.6+.8*Q(),Hb.elt=c.table;continue}}}}if(c.collide){c.colCpt=20,Hb.x+=m.x*m.l,Hb.y+=m.y*m.l,Hb.collide=!0;var L=u(Hb.v.x,Hb.v.y),M=Hb.v.x/L,O=Hb.v.y/L,P=-m.y,R=m.x,S=P*M+R*O;0>S&&(P=-P,R=-R);var T=M*m.x+O*m.y;0>T&&(T=-T);var U=N.sin(N.acos(T));0>U&&(U=-U);var V=.2;c.kind==Ob?V=1.3:c.kind==Sb&&(V=c.elt==Hb.elt?1.5:.5),m.x*=T*V*L,m.y*=T*V*L,P*=U*L,R*=U*L,Hb.v.x=m.x+P,Hb.v.y=m.y+R}}Hb.a.x=Hb.a.y=0,Hb.prevX=Hb.x,Hb.prevY=Hb.y,Hb.x+Ub<0?Zb=!1:Hb.x-Ub>fb?Zb=!1:Hb.y+Ub<0?Zb=!1:Hb.y-Ub>fb&&(Zb=!1)}var W;for(a=0,b=Fb.n;b>a;a++)W=Fb[a],W.cpt--,W.cpt>0&&(W.x+=W.v.x,W.y+=W.v.y);for(a=0;a<Fb.n;a++)W=Fb[a],0===W.cpt&&(Fb[a]=Fb[Fb.n-1],Fb[Fb.n-1]=W,Fb.n--,a--)}function e(){db=bb,eb=cb;var a=Hb.x,b=Hb.y,c=a-gb,d=b-gb,e=c,f=d;0>e&&(e*=-1),0>f&&(f*=-1);var g=W/2+Y;if(g>e&&g>f){var h=e-g,i=f-g,j=h*h+i*i;if(g*g>j){var k=P(j);h=h*g/k,i=i*g/k,a=h+g,b=i+g,0>c&&(a=-a),0>d&&(b=-b),a=gb+a,b=gb+b}}else f>e?a=gb:b=gb;a=t(a,Hb.x-.3*$,Hb.x+.3*$),b=t(b,Hb.y-.3*_,Hb.y+.3*_),a=t(a-$/2,0,fb-$),b=t(b-_/2,0,fb-_),Zb?(bb+=.3*(a-bb),cb+=.3*(b-cb)):(bb=a,cb=b)}function f(){var a=1;H(lb),H(pb),a&&(E(lb,mb,0,0),nb.clearRect(0,0,$,_),nb.save(),nb.globalAlpha=.9,E(nb,kb,-bb+db,-cb+eb),nb.restore(),H(lb),Hb.boostCpt>0?F(nb,Hb.prevX-bb,Hb.prevY-cb,6,Cb[Hb.elt][1]):F(nb,Hb.x-bb,Hb.y-cb,2,Cb[Hb.elt][1]));for(var b,c,d=0,e=Eb.length;e>d;d++){var f,g,h,i=Eb[d],j=i.x-bb,k=i.y-cb;if(i==Hb){if($b>0&&!Zb){var l=4*t($b/_b,0,1)>>0;j+=l*Q()>>0,k+=l*Q()>>0,4==l&&(g="#f00")}var m=N.atan2(Hb.v.y,Hb.v.x);Hb.cpt=++Hb.cpt%20;var n=Hb.cpt;n>10&&(n=20-n),g=Cb[Hb.elt][1],f=Cb[Hb.elt][0],0===n?F(pb,Hb.x-bb,Hb.y-cb,Ub,f,g):(C(pb,f,g,2),n*=.3*O/10,pb.beginPath(),pb.arc(Hb.x-bb,Hb.y-cb,Hb.r,m+n,m-n),pb.lineTo(Hb.x-bb,Hb.y-cb),pb.closePath(),pb.fill(),pb.stroke())}else i.shape==Kb?(i.kind==Nb?(f=0,g=0):(h=2,g=zb,f="#000",i.colCpt>0&&(i.colCpt--,g=Bb)),(f||g)&&F(pb,j,k,i.r,f,g,h)):i.shape==Lb&&(i.kind==Nb?g=0:(g=zb,i.kind==Qb&&(g=Cb[i.table][1])),g&&G(pb,i.x-bb,i.y-cb,i.x2-bb,i.y2-cb,g,2))}for(d=0;d<Gb.n;d++){var o=1,p=Gb[d],q=rb+2*qb,r=Db[Hb.elt]==p.elt,s=Hb.elt==p.elt;if(p.dead){if(p.cpt-=10,0===p.cpt){o=Gb[Gb.n-1],Gb[d]=o,Gb[Gb.n-1]=p,Gb.n--,d--;continue}o=p.cpt/50}else p.cpt<50&&(p.cpt++,o=p.cpt/50);s||(pb.globalAlpha=.2*o,F(pb,p.x-bb,p.y-cb,p.r,Cb[p.elt][0]),p.elt==V&&(pb.globalAlpha=1,pb.globalCompositeOperation="destination-out",F(pb,p.x-bb,p.y-cb,17,Cb[p.elt][0]),pb.globalCompositeOperation="source-over")),s&&(o*=.5),pb.globalAlpha=o,b=0,c=0,r||s||F(pb,p.x-bb,p.y-cb,p.r,null,Cb[p.elt][0]),r&&(b=3*(N.random()-.5),c=3*(N.random()-.5)),pb.drawImage(tb,p.elt*q,0,q,q,p.x-q/2-bb+b,p.y-q/2-cb+c,q,q)}pb.globalAlpha=1,E(lb,ib,-bb,-cb),a&&E(lb,mb,0,0),E(lb,ob,0,0)}function g(){for(var a=4;Gb.n<a;){var b;Gb.length==Gb.n?(b=j(Kb,Sb),Gb.push(b),b.elt=Gb.n%4,b.r=sb):b=Gb[Gb.n],Gb.n++;var c=Jb[Gb.n%Jb.length];b.x=c.x,b.y=c.y,b.cpt=0,b.dead=0,b.da=-2*c.da,b.a=c.a,b.d=c.d}}function h(){stb&&stb(),c(),d(),e(),f(),g(),window.requestAnimationFrame(h),ste&&ste()}function i(){Hb=k(l(gb,fb-50,Ub,Mb)),Hb.cpt=0,Hb.elt=-1,o(m(0,220,150,100,Pb)),Jb=[];for(var a=4,b=0;a>b;b++){var c=sb+4,d=2*c+(Z-2*c)*b/a>>0,e=2*Q()*O,f=l(0,0,c,Ob);Jb.push(k(f));var g=(.2+.2*Q())*(Q()>.5?-1:1);f.da=g/d,f.a=e,f.d=d,b>1&&(f=q(f),f.a+=O,Jb.push(k(f)))}o(m(150,100,300,30,Qb)),Ib=Eb.slice(-8);var h=Ib[0],i=u(h.x-h.x2,h.y-h.y2),j=2*-N.acos((h.x2-h.x)/i);for(b=0;b<Ib.length;b++)h=Ib[b],h.l=i,h.ux=h.x2-h.x,h.uy=h.y2-h.y,h.amax=j,(1==h.table||2==h.table)&&(h.amax*=-1)}function j(a,b,c,d){return{x:c||0,y:d||0,shape:a,kind:b,v:{x:0,y:0},a:{x:0,y:0}}}function k(a){return Eb.push(a),a}function l(a,b,c,d){var e=j(Kb,d,a,b);return e.r=c,e}function m(a,b,c,d,e){var f=j(Lb,e,a,b);return f.x2=c,f.y2=d,f}function n(a){for(var b=0;4>b;b++){var c=q(a);p(c,"x","y",b),c.shape==Lb&&p(c,"x2","y2",b),k(c),c.table=b}}function o(a){n(a),a.x=W-a.x,a.shape==Lb&&(a.x2=W-a.x2),a.mirror=!0,n(a)}function p(a,b,c,d){var e=a[b],f=a[c];if(0===d||2==d)e+=X+Y,0===d&&(f=fb-f);else{var g=f;f=X+Y+e,e=g,1==d&&(e=fb-e)}a[b]=e>>0,a[c]=f>>0}function q(a){return JSON.parse(JSON.stringify(a))}function r(a){return a}function s(a){return fb-a}function t(a,b,c){return b>a?b:a>c?c:a}function u(a,b){return P(a*a+b*b)}function v(a,b){b=(b||1)/u(a.x,a.y),a.x*=b,a.y*=b}function w(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.r+b.r;return e*e>c*c+d*d}function x(a,b,c){var d=a.x,e=a.y,f=a.r,g=b.x,h=b.y,i=b.x2,j=b.y2,k=i-g,l=j-h,m=N.sqrt(k*k+l*l),n=(i-g)/m,o=(j-h)/m,p=n*(d-g)+o*(e-h),q=p*n+g,r=p*o+h;if((i>g&&q>=g&&i>=q||g>i&&q>=i&&g>=q||g==i&&q==g)&&(j>h&&r>=h&&j>=r||h>j&&r>=j&&h>=r||h==j&&r==h)){var s=r-e,t=q-d,u=P(t*t+s*s);if(f>=u)return c.ex=q,c.ey=r,c.x=-t,c.y=-s,c.l=u,!0}return!1}function y(a,b,c,d,e){b==d?(a.vert=!0,a.x=b):(a.vert=!1,a.m=(c-e)/(b-d),a.p=c-a.m*b)}function z(a,b,c,d){return a.vert?b<a.x:d?b>(c-a.p)/a.m:c>a.m*b+a.p}function A(a,b){var c=L.createElement("canvas");return c.width=a,c.height=b,c}function B(a){return a.getContext("2d")}function C(a,b,c,d){0!==b&&(a.fillStyle=b),0!==c&&(a.strokeStyle=c),0!==d&&(a.lineWidth=d)}function D(a,b,c,d,e,f){f&&(f.width&&(f=a.createPattern(f,"repeat")),C(a,f)),a.fillRect(b,c,d,e)}function E(a,b,c,d){a.drawImage(b,c,d)}function F(a,b,c,d,e,f,g){C(a,e,f,g||2),a.beginPath(),a.arc(b,c,d,0,2*O,!1),e&&a.fill(),f&&a.stroke(),a.closePath()}function G(a,b,c,d,e,f,g){C(a,0,f,g||2),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.stroke()}function H(a){a.clearRect(0,0,$,_)}function I(a,b){b||(b=window.e);var c=b.keyCode;b.charCode&&!c&&(c=b.charCode),Xb[cc[c]]=a}function J(a,b){var c,d;"which"in b?(c=3==b.which,d=2==b.which):"button"in b&&(c=2==b.button,d=1==b.button),c?Yb.right=a:d?Yb.middle=a:Yb.left=a,Yb.x=b.clientX+bb,Yb.y=b.clientY+cb}var K=window,L=K.document,M=L.body,N=K.Math,O=N.PI,P=N.sqrt,Q=N.random,R=String.fromCharCode,S=0,T=1,U=2,V=3,W=700,X=220,Y=200,Z=Y+W/2;Z=u(Z,Z)-Y>>0;var $,_,ab,bb,cb,db,eb,fb=W+2*X+2*Y,gb=fb/2,hb=20,ib=A(fb,fb),jb=B(ib),kb=A($,_),lb=B(kb),mb=A($,_),nb=B(mb),ob=A($,_),pb=B(ob),qb=4,rb=40,sb=rb-2,tb=A(4*(rb+2*qb),rb+2*qb),ub=B(tb);window.onresize=function(){$=t(K.innerWidth,W,fb),_=t(K.innerHeight,W,fb),ab=N.min($,_),ob.width=mb.width=kb.width=$-=$%2,ob.height=mb.height=kb.height=_-=_%2},M.onresize(),M.appendChild(kb);var vb="#111",wb="#222",xb="#333",yb="#444",zb="#08e",Ab="#000",Bb="#0d0",Cb=[["#aef","#5af"],["#fa0","#f53"],["#a64","#864"],["rgba(255,255,255,0.5","#fff"]];Cb[-1]=["#ff6","#ff6"];var Db={};Db[S]=T,Db[T]=S,Db[U]=V,Db[V]=U;var Eb,Fb,Gb,Hb,Ib,Jb,Kb="c",Lb="l",Mb="b",Nb="bg",Ob="bp",Pb="o",Qb="p",Rb="s",Sb="m",Tb=15,Ub=14,Vb=.2,Wb=.99,Xb={},Yb={},Zb=!1,$b=0,_b=100,ac={},bc={};b(),h();var cc={37:"left",38:"up",39:"right",40:"down",32:"space",27:"esc",82:"R",13:"Enter"};L.onkeyup=function(a){I(!1,a),27==a.keyCode&&(window._stopped?(window._stopped=!1,window.requestAnimationFrame=window._raf):(window._stopped=!0,window._raf=window.requestAnimationFrame,window.requestAnimationFrame=function(){})),13==a.keyCode&&window._stopped&&h()},L.onkeydown=function(a){I(!0,a)},L.onmousedown=function(a){J(!0,a)},L.onmouseup=function(a){J(!1,a)},L.onmousemove=function(a){Yb.x=a.clientX+bb,Yb.y=a.clientY+cb},L.oncontextmenu=function(){return!1}};